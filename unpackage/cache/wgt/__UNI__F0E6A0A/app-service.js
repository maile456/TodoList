if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((i=>t.resolve(e()).then((()=>i))),(i=>t.resolve(e()).then((()=>{throw i}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...i){uni.__log__?uni.__log__(e,t,...i):console[e].apply(console,[...i,t])}function i(e,t){return"string"==typeof e?t:e}class s{constructor(e,t){this.options=e,this.animation=uni.createAnimation({...e}),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let i=this.currentStepAnimates[this.next],s={};if(s=i||{styles:{},config:{}},o.includes(e)){s.styles.transform||(s.styles.transform="");let i="";"rotate"===e&&(i="deg"),s.styles.transform+=`${e}(${t+i}) `}else s.styles[e]=`${t}`;this.currentStepAnimates[this.next]=s}_animateRun(e={},t={}){let i=this.$.$refs.ani.ref;if(i)return new Promise(((s,o)=>{nvueAnimation.transition(i,{styles:e,...t},(e=>{s()}))}))}_nvueNextAnimate(e,t=0,i){let s=e[t];if(s){let{styles:o,config:a}=s;this._animateRun(o,a).then((()=>{t+=1,this._nvueNextAnimate(e,t,i)}))}else this.currentStepAnimates={},"function"==typeof i&&i(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof e&&e()}),this.$.durationTime)}}const o=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function a(e,t){if(t)return clearTimeout(t.timer),new s(e,t)}o.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((e=>{s.prototype[e]=function(...t){return this.animation[e](...t),this}}));const n=(e,t)=>{const i=e.__vccOpts||e;for(const[s,o]of t)i[s]=o;return i};const r=n({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e={...this.styles,"transition-duration":this.duration/1e3+"s"},t="";for(let i in e){t+=this.toLine(i)+":"+e[i]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=a(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,i={}){if(this.animation){for(let i in e)try{"object"==typeof e[i]?this.animation[i](...e[i]):this.animation[i](e[i])}catch(s){t("error","at node_modules/@dcloudio/uni-ui/lib/uni-transition/uni-transition.vue:148",`方法 ${i} 不存在`)}return this.animation.step(i),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);void 0!==e&&(this.opacity=e),this.transform=t,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=a(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(e){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})}))},styleInit(e){let t={transform:""},i=(e,i)=>{"fade"===i?t.opacity=this.animationType(e)[i]:t.transform+=this.animationType(e)[i]+" "};return"string"==typeof this.modeClass?i(e,this.modeClass):this.modeClass.forEach((t=>{i(e,t)})),t},tranfromInit(e){let t=(e,t)=>{let i=null;"fade"===t?i=e?0:1:(i=e?"-100%":"0","zoom-in"===t&&(i=e?.8:1),"zoom-out"===t&&(i=e?1.2:1),"slide-right"===t&&(i=e?"100%":"0"),"slide-bottom"===t&&(i=e?"100%":"0")),this.animation[this.animationMode()[t]](i)};return"string"==typeof this.modeClass?t(e,this.modeClass):this.modeClass.forEach((i=>{t(e,i)})),this.animation},animationType:e=>({fade:e?0:1,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(t,i,s,o,a,n){return e.withDirectives((e.openBlock(),e.createElementBlock("view",{ref:"ani",animation:a.animationData,class:e.normalizeClass(s.customClass),style:e.normalizeStyle(n.transformStyles),onClick:i[0]||(i[0]=(...e)=>n.onClick&&n.onClick(...e))},[e.renderSlot(t.$slots,"default")],14,["animation"])),[[e.vShow,a.isShow]])}]]);const l=n({name:"uniPopup",components:{},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"},borderRadius:{type:String}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0},isMaskClick:{handler:function(e){this.mkclick=e},immediate:!0},showPopup(e){}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{backgroundColor:"transparent",borderRadius:this.borderRadius||"0",position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:"top"}},computed:{getStyles(){let e={backgroundColor:this.bg};return this.borderRadius,e=Object.assign(e,{borderRadius:this.borderRadius}),e},isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:e,windowHeight:t,windowTop:i,safeArea:s,screenHeight:o,safeAreaInsets:a}=uni.getSystemInfoSync();this.popupWidth=e,this.popupHeight=t+(i||0),s&&this.safeArea?this.safeAreaInsets=a.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},activated(){this.setH5Visible(!this.showPopup)},deactivated(){this.setH5Visible(!0)},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(e=!0){},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){e.stopPropagation(),this.clearPropagation=!0},open(e){if(this.showPopup)return;e&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(e)||(e=this.type),this.config[e]?(this[this.config[e]](),this.$emit("change",{show:!0,type:e})):t("error","at node_modules/@dcloudio/uni-ui/lib/uni-popup/uni-popup.vue:310","缺少类型：",e)},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.showPoptrans(),this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||this.showPoptrans()},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center",borderRadius:this.borderRadius||"0"},e||this.showPoptrans()},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||this.showPoptrans()},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||this.showPoptrans()},showPoptrans(){this.$nextTick((()=>{this.showPopup=!0,this.showTrans=!0}))}}},[["render",function(t,s,o,a,n,l){const c=i(e.resolveDynamicComponent("uni-transition"),r);return n.showPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-popup",[n.popupstyle,l.isDesktop?"fixforpc-z-index":""]])},[e.createElementVNode("view",{onTouchstart:s[1]||(s[1]=(...e)=>l.touchstart&&l.touchstart(...e))},[n.maskShow?(e.openBlock(),e.createBlock(c,{key:"1",name:"mask","mode-class":"fade",styles:n.maskClass,duration:n.duration,show:n.showTrans,onClick:l.onTap},null,8,["styles","duration","show","onClick"])):e.createCommentVNode("",!0),e.createVNode(c,{key:"2","mode-class":n.ani,name:"content",styles:n.transClass,duration:n.duration,show:n.showTrans,onClick:l.onTap},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-popup__wrapper",[n.popupstyle]]),style:e.normalizeStyle(l.getStyles),onClick:s[0]||(s[0]=(...e)=>l.clear&&l.clear(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)])),_:3},8,["mode-class","styles","duration","show","onClick"])],32)],2)):e.createCommentVNode("",!0)}],["__scopeId","data-v-d77bc3e8"]]);let c={};c={data:()=>({is_show:"none"}),watch:{show(e){this.is_show=this.show}},created(){this.swipeaction=this.getSwipeAction(),this.swipeaction&&Array.isArray(this.swipeaction.children)&&this.swipeaction.children.push(this)},mounted(){this.is_show=this.show},methods:{closeSwipe(e){this.autoClose&&this.swipeaction&&this.swipeaction.closeOther(this)},change(e){this.$emit("change",e.open),this.is_show!==e.open&&(this.is_show=e.open)},appTouchStart(e){const{clientX:t}=e.changedTouches[0];this.clientX=t,this.timestamp=(new Date).getTime()},appTouchEnd(e,t,i,s){const{clientX:o}=e.changedTouches[0];let a=Math.abs(this.clientX-o),n=(new Date).getTime()-this.timestamp;a<40&&n<300&&this.$emit("click",{content:i,index:t,position:s})},onClickForPC(e,t,i){}}};const d=e=>{(e.$wxs||(e.$wxs=[])).push("wxsswipe"),(e.$wxsModules||(e.$wxsModules={})).wxsswipe="1f58cc29"},h=e=>{(e.$renderjs||(e.$renderjs=[])).push("renderswipe"),(e.$renderjsModules||(e.$renderjsModules={})).renderswipe="74bb5072"},p={mixins:[c,{},{}],emits:["click","change"],props:{show:{type:String,default:"none"},disabled:{type:Boolean,default:!1},autoClose:{type:Boolean,default:!0},threshold:{type:Number,default:20},leftOptions:{type:Array,default:()=>[]},rightOptions:{type:Array,default:()=>[]}},unmounted(){this.__isUnmounted=!0,this.uninstall()},methods:{uninstall(){this.swipeaction&&this.swipeaction.children.forEach(((e,t)=>{e===this&&this.swipeaction.children.splice(t,1)}))},getSwipeAction(e="uniSwipeAction"){let t=this.$parent,i=t.$options.name;for(;i!==e;){if(t=t.$parent,!t)return!1;i=t.$options.name}return t}}};d(p),h(p);const u=n(p,[["render",function(t,i,s,o,a,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-swipe"},[e.createElementVNode("view",{class:"uni-swipe_box","change:prop":t.wxsswipe.showWatch,prop:e.wp(t.is_show),"data-threshold":s.threshold,"data-disabled":s.disabled,onTouchstart:i[2]||(i[2]=(...e)=>t.wxsswipe.touchstart&&t.wxsswipe.touchstart(...e)),onTouchmove:i[3]||(i[3]=(...e)=>t.wxsswipe.touchmove&&t.wxsswipe.touchmove(...e)),onTouchend:i[4]||(i[4]=(...e)=>t.wxsswipe.touchend&&t.wxsswipe.touchend(...e))},[e.createElementVNode("view",{class:"uni-swipe_button-group button-group--left"},[e.renderSlot(t.$slots,"left",{},(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.leftOptions,((s,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,style:e.normalizeStyle({backgroundColor:s.style&&s.style.backgroundColor?s.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:i[0]||(i[0]=e.withModifiers(((...e)=>t.appTouchStart&&t.appTouchStart(...e)),["stop"])),onTouchend:e.withModifiers((e=>t.appTouchEnd(e,o,s,"left")),["stop"]),onClick:e.withModifiers((e=>t.onClickForPC(o,s,"left")),["stop"])},[e.createElementVNode("text",{class:"uni-swipe_button-text",style:e.normalizeStyle({color:s.style&&s.style.color?s.style.color:"#FFFFFF",fontSize:s.style&&s.style.fontSize?s.style.fontSize:"16px"})},e.toDisplayString(s.text),5)],44,["onTouchend","onClick"])))),128))]),!0)]),e.createElementVNode("view",{class:"uni-swipe_text--center"},[e.renderSlot(t.$slots,"default",{},void 0,!0)]),e.createElementVNode("view",{class:"uni-swipe_button-group button-group--right"},[e.renderSlot(t.$slots,"right",{},(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.rightOptions,((s,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,style:e.normalizeStyle({backgroundColor:s.style&&s.style.backgroundColor?s.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:i[1]||(i[1]=e.withModifiers(((...e)=>t.appTouchStart&&t.appTouchStart(...e)),["stop"])),onTouchend:e.withModifiers((e=>t.appTouchEnd(e,o,s,"right")),["stop"]),onClick:e.withModifiers((e=>t.onClickForPC(o,s,"right")),["stop"])},[e.createElementVNode("text",{class:"uni-swipe_button-text",style:e.normalizeStyle({color:s.style&&s.style.color?s.style.color:"#FFFFFF",fontSize:s.style&&s.style.fontSize?s.style.fontSize:"16px"})},e.toDisplayString(s.text),5)],44,["onTouchend","onClick"])))),128))]),!0)])],40,["change:prop","prop","data-threshold","data-disabled"])])}],["__scopeId","data-v-a92d8875"]]);const m=n({name:"uniSwipeAction",data:()=>({}),created(){this.children=[]},methods:{resize(){},closeAll(){this.children.forEach((e=>{e.is_show="none"}))},closeOther(e){this.openItem&&this.openItem!==e&&(this.openItem.is_show="none"),this.openItem=e}}},[["render",function(t,i,s,o,a,n){return e.openBlock(),e.createElementBlock("view",null,[e.renderSlot(t.$slots,"default")])}]]),k="/static/empty-tasks.png";const g="tasks";function y(){try{const e=uni.getStorageSync(g);return e?JSON.parse(e):[]}catch(e){return t("error","at utils/storage.js:16","获取任务列表失败:",e),[]}}const f=n({components:{todoItemList:n({props:{tasks:{type:Array,default:()=>[]}},computed:{groupedTasks(){const e=(new Date).toISOString().split("T")[0];return[{title:"今日待办",tasks:this.tasks.filter((t=>!t.completed&&t.dueDate===e))},{title:"待办任务",tasks:this.tasks.filter((t=>!t.completed&&(!t.dueDate||t.dueDate>e)))},{title:"已完成",tasks:this.tasks.filter((e=>e.completed))}].filter((e=>e.tasks.length>0))}},methods:{handleTaskTap(e){this.$emit("view",e.id)},toggleCompletion(e){this.$emit("toggle",e.id)},confirmDelete(e){uni.showModal({title:"确认删除",content:`是否删除任务"${e.name}"？`,success:t=>{t.confirm&&this.$emit("delete",e.id)}})},isOverdue:e=>new Date(e)<(new Date).setHours(0,0,0,0),isDueToday:e=>e===(new Date).toISOString().split("T")[0],formatDueDate(e){const t=(new Date).toISOString().split("T")[0],i=new Date(Date.now()+864e5).toISOString().split("T")[0];return e===t?"今天":e===i?"明天":e.replace(/(\d{4})-(\d{2})-(\d{2})/,"$2月$3日")},getPriorityLabel:e=>["低","中","高"][e]||"中",getPriorityClass:e=>({"priority-low":0===e,"priority-medium":1===e,"priority-high":2===e})}},[["render",function(t,s,o,a,n,r){const l=i(e.resolveDynamicComponent("uni-swipe-action-item"),u),c=i(e.resolveDynamicComponent("uni-swipe-action"),m);return e.openBlock(),e.createElementBlock("view",{class:"task-list"},[r.groupedTasks.length?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(r.groupedTasks,((i,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:"task-group"},[e.createElementVNode("view",{class:"group-header"},[e.createElementVNode("text",{class:"group-title"},e.toDisplayString(i.title),1),e.createElementVNode("text",{class:"task-count"},e.toDisplayString(i.tasks.length)+"项",1)]),e.createElementVNode("view",{class:"task-items"},[e.createVNode(c,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.tasks,(i=>(e.openBlock(),e.createBlock(l,{key:i.id,"right-options":t.swipeOptions,onClick:e=>t.handleSwipeClick(e,i)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["task-item",{"task-completed":i.completed}]),onClick:e=>r.handleTaskTap(i)},[e.createElementVNode("view",{class:e.normalizeClass(["checkbox",{checked:i.completed}]),onClick:e.withModifiers((e=>r.toggleCompletion(i)),["stop"])},[i.completed?(e.openBlock(),e.createElementBlock("text",{key:0,class:"check-mark"},"✓")):e.createCommentVNode("",!0)],10,["onClick"]),e.createElementVNode("view",{class:"task-content"},[e.createElementVNode("view",{class:"task-main"},[e.createElementVNode("text",{class:e.normalizeClass(["task-name",{"text-completed":i.completed}])},e.toDisplayString(i.name),3),e.createElementVNode("view",{class:"task-actions"},[i.completed?(e.openBlock(),e.createElementBlock("text",{key:1,class:"action-btn delete-btn",onClick:e.withModifiers((e=>r.confirmDelete(i)),["stop"])}," 删除 ",8,["onClick"])):(e.openBlock(),e.createElementBlock("text",{key:0,class:"action-btn edit-btn",onClick:e.withModifiers((e=>t.$emit("edit",i.id)),["stop"])}," 编辑 ",8,["onClick"]))])]),i.dueDate||void 0!==i.priority?(e.openBlock(),e.createElementBlock("view",{key:0,class:"task-details"},[i.dueDate?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass(["due-date",{overdue:r.isOverdue(i.dueDate)&&!i.completed,"due-today":r.isDueToday(i.dueDate)&&!i.completed}])},e.toDisplayString(r.formatDueDate(i.dueDate)),3)):e.createCommentVNode("",!0),void 0!==i.priority?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["priority-tag",r.getPriorityClass(i.priority)])},e.toDisplayString(r.getPriorityLabel(i.priority)),3)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)])],10,["onClick"])])),_:2},1032,["right-options","onClick"])))),128))])),_:2},1024)])])))),128)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("view",{class:"empty-content"},[e.createElementVNode("image",{src:k,mode:"aspectFit",class:"empty-image"}),e.createElementVNode("text",{class:"empty-text"},"暂无待办事项")])]))])}],["__scopeId","data-v-30cd322b"]])},data:()=>({tasks:[],filterOptions:[{label:"全部",value:"all"},{label:"未完成",value:"active"},{label:"已完成",value:"completed"}],currentFilter:{label:"全部",value:"all"}}),computed:{filteredTasks(){switch(this.currentFilter.value){case"active":return this.tasks.filter((e=>!e.completed));case"completed":return this.tasks.filter((e=>e.completed));default:return this.tasks}}},methods:{goToAddTodo(){uni.navigateTo({url:"/pages/addTodo/addTodo"})},goToTodoItem(e){uni.navigateTo({url:`/pages/todoItem/todoItem?id=${e}`})},getTasksFromStorage(){try{this.tasks=y()}catch(e){uni.showToast({title:"加载任务失败",icon:"none"})}},confirmDelete(e){uni.showModal({title:"确认删除",content:"是否确定删除该任务？",success:t=>{t.confirm&&this.deleteTask(e)}})},deleteTask(e){const t=this.tasks.findIndex((t=>t.id===e));-1!==t&&(this.tasks.splice(t,1),this.saveTasksToStorage(),uni.showToast({title:"已删除",icon:"success"}))},toggleTask(e){const t=this.tasks.find((t=>t.id===e));t&&(t.completed=!t.completed,t.completedAt=t.completed?(new Date).toISOString():null,this.saveTasksToStorage())},saveTasksToStorage(){try{uni.setStorageSync("tasks",JSON.stringify(this.tasks))}catch(e){uni.showToast({title:"保存失败",icon:"none"})}},showFilter(){this.$refs.filterPopup.open()},hideFilter(){this.$refs.filterPopup.close()},selectFilter(e){this.currentFilter=e,this.hideFilter()}},onShow(){this.getTasksFromStorage()}},[["render",function(t,s,o,a,n,r){const c=e.resolveComponent("todoItemList"),d=i(e.resolveDynamicComponent("uni-popup"),l);return e.openBlock(),e.createElementBlock("view",{class:"ios-container"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("text",{class:"nav-title"},"待办事项"),e.createElementVNode("view",{class:"nav-right"},[e.createElementVNode("text",{class:"nav-btn",onClick:s[0]||(s[0]=(...e)=>r.showFilter&&r.showFilter(...e))},[e.createTextVNode(e.toDisplayString(n.currentFilter.label)+" ",1),e.createElementVNode("text",{class:"arrow-down"},"▼")])])]),e.createElementVNode("view",{class:e.normalizeClass(["todo-list",{empty:!r.filteredTasks.length}])},[r.filteredTasks.length?(e.openBlock(),e.createBlock(c,{key:0,tasks:r.filteredTasks,onEdit:r.goToTodoItem,onDelete:r.deleteTask,onToggle:r.toggleTask,onRefresh:r.getTasksFromStorage},null,8,["tasks","onEdit","onDelete","onToggle","onRefresh"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("image",{src:k,mode:"aspectFit",class:"empty-image"}),e.createElementVNode("text",{class:"empty-text"},"暂无待办事项")]))],2),e.createElementVNode("view",{class:"add-btn",onClick:s[1]||(s[1]=(...e)=>r.goToAddTodo&&r.goToAddTodo(...e))},[e.createElementVNode("text",{class:"add-icon"},"+")]),e.createVNode(d,{ref:"filterPopup",type:"bottom"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"filter-popup"},[e.createElementVNode("view",{class:"filter-header"},[e.createElementVNode("text",null,"筛选任务"),e.createElementVNode("text",{class:"close-btn",onClick:s[2]||(s[2]=(...e)=>r.hideFilter&&r.hideFilter(...e))},"完成")]),e.createElementVNode("view",{class:"filter-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.filterOptions,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.value,class:e.normalizeClass(["filter-item",{active:n.currentFilter.value===t.value}]),onClick:e=>r.selectFilter(t)},[e.createElementVNode("text",null,e.toDisplayString(t.label),1),n.currentFilter.value===t.value?(e.openBlock(),e.createElementBlock("text",{key:0,class:"check-mark"},"✓")):e.createCommentVNode("",!0)],10,["onClick"])))),128))])])])),_:1},512)])}],["__scopeId","data-v-03513b99"]]);const w=n({data:()=>({taskName:"",selectedPriority:1,priorities:["低","中","高"],isValidTask:!1,dueDate:"",today:(new Date).toISOString().split("T")[0],statusBarHeight:0}),onLoad(){const e=uni.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight},methods:{validateInput(){this.isValidTask=this.taskName.trim().length>0},onDateChange(e){this.dueDate=e.detail.value},formatDate(e){if(!e)return"";const t=(new Date).toISOString().split("T")[0],i=new Date(Date.now()+864e5).toISOString().split("T")[0];return e===t?"今天":e===i?"明天":e.replace(/(\d{4})-(\d{2})-(\d{2})/,"$2月$3日")},goBack(){this.taskName.trim()?uni.showModal({title:"提示",content:"是否放弃创建任务？",success:e=>{e.confirm&&uni.navigateBack()}}):uni.navigateBack()},addTask(){if(!this.isValidTask)return;!function(e){try{const t=y(),i={id:Date.now(),name:e.name,completed:!1,priority:e.priority||1,createTime:(new Date).toISOString(),updateTime:(new Date).toISOString(),dueDate:e.dueDate||null,completedTime:null,notes:e.notes||""};t.push(i),uni.setStorageSync(g,JSON.stringify(t))}catch(i){return t("error","at utils/storage.js:46","保存任务失败:",i),!1}}({id:Date.now(),name:this.taskName.trim(),completed:!1,priority:this.selectedPriority,dueDate:this.dueDate,createTime:(new Date).toISOString()}),uni.showToast({title:"已添加任务",icon:"success"}),setTimeout((()=>uni.navigateBack()),1500)}}},[["render",function(t,i,s,o,a,n){return e.openBlock(),e.createElementBlock("view",{class:"ios-container"},[e.createElementVNode("view",{class:"nav-bar",style:e.normalizeStyle({paddingTop:a.statusBarHeight+"px"})},[e.createElementVNode("text",{class:"nav-btn cancel",onClick:i[0]||(i[0]=(...e)=>n.goBack&&n.goBack(...e))},"取消"),e.createElementVNode("text",{class:"nav-title"},"新建任务"),e.createElementVNode("text",{class:e.normalizeClass(["nav-btn confirm",{disabled:!a.isValidTask}]),onClick:i[1]||(i[1]=(...e)=>n.addTask&&n.addTask(...e))},"完成",2)],4),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"form-group"},[e.withDirectives(e.createElementVNode("input",{class:"ios-input","onUpdate:modelValue":i[2]||(i[2]=e=>a.taskName=e),placeholder:"任务名称","placeholder-class":"placeholder",onInput:i[3]||(i[3]=(...e)=>n.validateInput&&n.validateInput(...e)),maxlength:"50"},null,544),[[e.vModelText,a.taskName]]),e.createElementVNode("text",{class:"char-count"},e.toDisplayString(a.taskName.length)+"/50",1)]),e.createElementVNode("view",{class:"form-group priority-section"},[e.createElementVNode("text",{class:"group-label"},"优先级"),e.createElementVNode("view",{class:"priority-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.priorities,((t,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:e.normalizeClass(["priority-item",{active:a.selectedPriority===i}]),onClick:e=>a.selectedPriority=i},e.toDisplayString(t),11,["onClick"])))),128))])]),e.createElementVNode("view",{class:"form-group date-section"},[e.createElementVNode("text",{class:"group-label"},"截止日期"),e.createElementVNode("picker",{mode:"date",value:a.dueDate,start:a.today,end:"2030-12-31",onChange:i[4]||(i[4]=(...e)=>n.onDateChange&&n.onDateChange(...e))},[e.createElementVNode("view",{class:"date-picker"},[e.createElementVNode("text",{class:e.normalizeClass({placeholder:!a.dueDate})},e.toDisplayString(a.dueDate?n.formatDate(a.dueDate):"请选择日期"),3),e.createElementVNode("text",{class:"arrow"},"›")])],40,["value","start"])])])])}],["__scopeId","data-v-cbf1c1d9"]]);const C=n({data:()=>({taskId:null,taskName:"",selectedPriority:1,dueDate:"",priorities:["低","中","高"],isValidTask:!1,originalTask:null,statusBarHeight:0,today:(new Date).toISOString().split("T")[0]}),onLoad(e){const t=uni.getSystemInfoSync();this.statusBarHeight=t.statusBarHeight,this.taskId=e.id,this.taskId&&this.loadTask()},methods:{validateInput(){this.isValidTask=this.taskName.trim().length>0},loadTask(){try{const e=function(e){try{return y().find((t=>t.id===parseInt(e)))||null}catch(i){return t("error","at utils/storage.js:61","获取任务详情失败:",i),null}}(this.taskId);e?(this.taskName=e.name,this.selectedPriority=e.priority||1,this.dueDate=e.dueDate||"",this.originalTask={...e},this.validateInput()):this.handleLoadError()}catch(e){this.handleLoadError()}},handleLoadError(){uni.showToast({title:"加载任务失败",icon:"none"}),setTimeout((()=>uni.navigateBack()),1500)},formatDate(e){if(!e)return"";const t=(new Date).toISOString().split("T")[0],i=new Date(Date.now()+864e5).toISOString().split("T")[0];return e===t?"今天":e===i?"明天":e.replace(/(\d{4})-(\d{2})-(\d{2})/,"$2月$3日")},onDateChange(e){this.dueDate=e.detail.value},handleBack(){this.hasChanges()?uni.showModal({title:"提示",content:"是否放弃更改？",success:e=>{e.confirm&&uni.navigateBack()}}):uni.navigateBack()},hasChanges(){var e,t,i;return this.taskName!==(null==(e=this.originalTask)?void 0:e.name)||this.selectedPriority!==(null==(t=this.originalTask)?void 0:t.priority)||this.dueDate!==(null==(i=this.originalTask)?void 0:i.dueDate)},saveChanges(){if(this.isValidTask)try{!function(e){try{const t=y(),i=t.findIndex((t=>t.id===parseInt(e.id)));if(-1!==i){const s=t[i];return t[i]={...s,...e,updateTime:(new Date).toISOString(),completedTime:e.completed?s.completed?s.completedTime:(new Date).toISOString():null},uni.setStorageSync(g,JSON.stringify(t)),!0}}catch(i){return t("error","at utils/storage.js:94","更新任务失败:",i),!1}}({id:this.taskId,name:this.taskName.trim(),priority:this.selectedPriority,dueDate:this.dueDate,updateTime:(new Date).toISOString()}),uni.showToast({title:"已保存",icon:"success"}),setTimeout((()=>uni.navigateBack()),1500)}catch(e){uni.showToast({title:"保存失败",icon:"none"})}},confirmDelete(){uni.showModal({title:"确认删除",content:"是否确定删除该任务？",success:e=>{e.confirm&&this.handleDelete()}})},handleDelete(){try{!function(e){try{const t=y().filter((t=>t.id!==e));uni.setStorageSync(g,JSON.stringify(t))}catch(i){return t("error","at utils/storage.js:114","删除任务失败:",i),!1}}(this.taskId),uni.showToast({title:"已删除",icon:"success"}),setTimeout((()=>uni.navigateBack()),1500)}catch(e){uni.showToast({title:"删除失败",icon:"none"})}}}},[["render",function(t,i,s,o,a,n){return e.openBlock(),e.createElementBlock("view",{class:"ios-container"},[e.createElementVNode("view",{class:"nav-bar",style:e.normalizeStyle({paddingTop:a.statusBarHeight+"px"})},[e.createElementVNode("text",{class:"nav-btn cancel",onClick:i[0]||(i[0]=(...e)=>n.handleBack&&n.handleBack(...e))},"取消"),e.createElementVNode("text",{class:"nav-title"},"编辑任务"),e.createElementVNode("text",{class:e.normalizeClass(["nav-btn confirm",{disabled:!a.isValidTask}]),onClick:i[1]||(i[1]=(...e)=>n.saveChanges&&n.saveChanges(...e))},"完成",2)],4),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("view",{class:"form-group"},[e.withDirectives(e.createElementVNode("input",{class:"ios-input","onUpdate:modelValue":i[2]||(i[2]=e=>a.taskName=e),placeholder:"任务名称","placeholder-class":"placeholder",onInput:i[3]||(i[3]=(...e)=>n.validateInput&&n.validateInput(...e)),maxlength:"50"},null,544),[[e.vModelText,a.taskName]]),e.createElementVNode("text",{class:"char-count"},e.toDisplayString(a.taskName.length)+"/50",1)]),e.createElementVNode("view",{class:"form-group priority-section"},[e.createElementVNode("text",{class:"group-label"},"优先级"),e.createElementVNode("view",{class:"priority-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.priorities,((t,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:e.normalizeClass(["priority-item",{active:a.selectedPriority===i}]),onClick:e=>a.selectedPriority=i},e.toDisplayString(t),11,["onClick"])))),128))])]),e.createElementVNode("view",{class:"form-group date-section"},[e.createElementVNode("text",{class:"group-label"},"截止日期"),e.createElementVNode("picker",{mode:"date",value:a.dueDate,start:a.today,end:"2030-12-31",onChange:i[4]||(i[4]=(...e)=>n.onDateChange&&n.onDateChange(...e))},[e.createElementVNode("view",{class:"date-picker"},[e.createElementVNode("text",{class:e.normalizeClass({placeholder:!a.dueDate})},e.toDisplayString(a.dueDate?n.formatDate(a.dueDate):"请选择日期"),3),e.createElementVNode("text",{class:"arrow"},"›")])],40,["value","start"])])]),a.taskId?(e.openBlock(),e.createElementBlock("view",{key:0,class:"delete-section"},[e.createElementVNode("button",{class:"delete-btn",onClick:i[5]||(i[5]=(...e)=>n.confirmDelete&&n.confirmDelete(...e))},"删除任务")])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-16fa44c3"]]);__definePage("pages/index/index",f),__definePage("pages/addTodo/addTodo",w),__definePage("pages/todoItem/todoItem",C);const v={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:T,Vuex:S,Pinia:b}={app:e.createVueApp(v)};uni.Vuex=S,uni.Pinia=b,T.provide("__globalStyles",__uniConfig.styles),T._component.mpType="app",T._component.render=()=>{},T.mount("#app")}(Vue);
